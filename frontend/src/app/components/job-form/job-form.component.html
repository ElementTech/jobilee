<div>
  <p-fieldset legend="{{formType}} Job" [toggleable]="false">
    <form (ngSubmit)="onSubmit()">
      <div class="grid">
        <div class="col-6">
          <h5>Name</h5>
          <input pInputText class="min-w-full" type="text" id="name" required [(ngModel)]="job.name" name="name" placeholder="myapi">
        </div>
        <div class="col-6">
          <h5>Integration</h5>
          <p-dropdown name="integration"  class="min-w-max" [options]="integrations"  [(ngModel)]="job.integration" optionValue="name" optionLabel="name"></p-dropdown>
        </div>
        <div class="col-6">
 
          <h5>API ID</h5>
          <div class="p-inputgroup">
              <span class="p-inputgroup-addon min-w-min">{{getURL(job.integration)}}{{getPrefix(job.integration)}}</span>  
              <input pInputText class="min-w-min" type="text" id="apiID" required [(ngModel)]="job.apiID" name="apiID" placeholder="id">
              <span class="p-inputgroup-addon" *ngIf="getSuffix(job.integration) != ''">{{getSuffix(job.integration)}}</span>      
          </div>
        </div>
    
  
        </div>
        <p-fieldset legend="Parameters" [toggleable]="false">
          <div class="grid">
            <json-editor class="col" [options]="editorOptions" [(ngModel)]="job.parameters" [ngModelOptions]=" 
            {standalone: true}"></json-editor>
            <p-divider layout="vertical">  <i class="pi pi-arrow-right"></i></p-divider>
            <div class="col">
              <p-scrollPanel [style]="{width: '100%', height: '400px'}">
                <div class="grid">
                  <div *ngFor="let param of job.parameters" class="col-6">
                    <p-divider align="left" type="dashed">
                      <div class="inline-flex align-items-center">
                        <ng-container>
                          <i *ngIf="param.type == 'text'" class="pi pi-book mr-2"></i>
                          <i *ngIf="param.type == 'choice'" class="pi pi-qrcode mr-2"></i>
                          <i *ngIf="param.type == 'multi-choice'" class="pi pi-check-square mr-2"></i>
                          <i *ngIf="param.type == 'dynamic'" class="pi pi-bolt mr-2"></i>
                          <b>{{param.name}}</b>
                        </ng-container>
                      </div>
                    </p-divider>
                    <input *ngIf="param.type == 'text'" class="min-w-full" type="text" pInputText [value]="param.default ? param.default : ''" />
                    <p-dropdown  *ngIf="param.type == 'choice'" appendTo="body" placeholder="{{param.choices[0]}}"  [ngModelOptions]="{standalone: true}" [(ngModel)]="param.default" [options]="param.choices"></p-dropdown>
                    <p-multiSelect *ngIf="param.type == 'multi-choice'" [defaultLabel]="param.choices" [ngModelOptions]="{standalone: true}" [(ngModel)]="param.default" [options]="param.choices"></p-multiSelect>
                    <p-multiSelect 
                      *ngIf="param.type == 'dynamic'" 
                      [defaultLabel]="param.default" 
                      [ngModelOptions]="{standalone: true}" 
                      [(ngModel)]="param.default" 
                      [options]="getOptions(param) | async"
                      >
                      <!-- [dropdownIcon]="'pi pi-spin pi-spinner'" -->
                    
                    </p-multiSelect>
                  </div>
                </div>
  
                
            

         
            
              </p-scrollPanel>
            </div>
          </div>
        </p-fieldset>
  
        <p-button type="submit" label="{{formType}}" icon="pi pi-check" class="fixed submitBtn" styleClass="p-button-lg"></p-button>
    </form>
  </p-fieldset>
</div>
